---
title: v1.2.609
tag: v1.2.609
draft: true
prerelease: false
author: everpcpc
created: 2024-08-13T22:25:19Z
url: https://github.com/datafuselabs/databend/releases/tag/untagged-560490c37f2740b7e6fb
---

<!-- 使用 .github/release.yml 中的配置生成的发布说明 -->

## 更新内容

### 激动人心的新功能 ✨

- 功能: 支持在多个地方使用递归CTE by @xudong963 in [#15835](https://github.com/datafuselabs/databend/pull/15835)
- 功能(查询): 支持哈希连接的DISTINCT FROM by @Dousir9 in [#15838](https://github.com/datafuselabs/databend/pull/15838)
- 功能: 为CatalogInfo实现Default by @Xuanwo in [#15844](https://github.com/datafuselabs/databend/pull/15844)
- 功能(查询): 在UDF调用中启用UDF by @sundy-li in [#15839](https://github.com/datafuselabs/databend/pull/15839)
- 功能(查询): 支持MERGE INTO的行获取 by @Dousir9 in [#15859](https://github.com/datafuselabs/databend/pull/15859)
- 功能: 在加载数据时，当某些行中UUID缺失/为空时填充UUID by @youngsofun in [#15871](https://github.com/datafuselabs/databend/pull/15871)
- 功能: 为`COPY INTO LOCATION FROM`语句提供流消费 by @dantengsky in [#15882](https://github.com/datafuselabs/databend/pull/15882)
- 功能: 将databend-common-ast发布到crates.io by @andylokandy in [#15905](https://github.com/datafuselabs/databend/pull/15905)
- 功能: 在磁盘上持久化Meta-Service状态机 by @drmingdrmer in [#15772](https://github.com/datafuselabs/databend/pull/15772)
- 功能: 故障安全工具`fuse_amend` by @dantengsky in [#15929](https://github.com/datafuselabs/databend/pull/15929)
- 功能: 重构创建共享端点的DDL by @lichuang in [#15937](https://github.com/datafuselabs/databend/pull/15937)
- 功能: 在配置中添加内置UDF by @BohuTANG in [#15938](https://github.com/datafuselabs/databend/pull/15938)
- 功能(规划器): 当仅插入时，支持MERGE INTO的列修剪 by @Dousir9 in [#15948](https://github.com/datafuselabs/databend/pull/15948)
- 功能: ClickHouse处理程序不再支持带有格式的INSERT by @youngsofun in [#15952](https://github.com/datafuselabs/databend/pull/15952)
- 功能(查询): 数组lambda函数支持外部作用域列 by @b41sh in [#15957](https://github.com/datafuselabs/databend/pull/15957)
- 功能: 支持从管理API实时检索配置文件（第1部分） by @dqhl76 in [#15958](https://github.com/datafuselabs/databend/pull/15958)
- 功能: 重构从共享创建数据库的DDL by @lichuang in [#15950](https://github.com/datafuselabs/databend/pull/15950)
- 功能: 漂亮的打印回溯信息 by @andylokandy in [#15913](https://github.com/datafuselabs/databend/pull/15913)
- 功能: 允许元组字段名称包含'_' by @youngsofun in [#15965](https://github.com/datafuselabs/databend/pull/15965)
- 功能(查询): 支持ALTER USER修改当前密码 by @TCeason in [#15962](https://github.com/datafuselabs/databend/pull/15962)
- 功能: 更新多路归并排序算法，使用败者树 by @forsaken628 in [#15869](https://github.com/datafuselabs/databend/pull/15869)
- 功能: ORC支持缺失字段 by @youngsofun in [#15970](https://github.com/datafuselabs/databend/pull/15970)
- 功能: ORC添加选项missing_field_as by @youngsofun in [#15974](https://github.com/datafuselabs/databend/pull/15974)
- 功能(执行器): 支持集群模式的错误分析 by @zhang2014 in [#15969](https://github.com/datafuselabs/databend/pull/15969)
- 功能(查询): 实现HAVERSINE函数 by @kkk25641463 in [#15971](https://github.com/datafuselabs/databend/pull/15971)
- 功能(查询): 实现st_length/st_distance函数 by @kkk25641463 in [#15982](https://github.com/datafuselabs/databend/pull/15982)
- 功能: 配置选项，用于同步磁盘缓存数据 by @dantengsky in [#15984](https://github.com/datafuselabs/databend/pull/15984)
- 功能: 在UDF客户端中添加租户和查询ID by @BohuTANG in [#15987](https://github.com/datafuselabs/databend/pull/15987)
- 功能: 通过引入InputColumns减少transform aggregate中的column.clone开销 by @forsaken628 in [#15991](https://github.com/datafuselabs/databend/pull/15991)
- 功能: 支持从管理API实时检索配置文件（第2部分） by @dqhl76 in [#15975](https://github.com/datafuselabs/databend/pull/15975)
- 功能: Parquet添加选项`missing_field_as` by @youngsofun in [#15993](https://github.com/datafuselabs/databend/pull/15993)
- 功能: HTTP处理程序将每个响应的body大小限制为10MB by @youngsofun in [#15960](https://github.com/datafuselabs/databend/pull/15960)
- 功能: 添加NameResolutionSuggest，增强表名大小写敏感错误提示 by @forsaken628 in [#15889](https://github.com/datafuselabs/databend/pull/15889)
- 功能: 重构共享规范位置和格式 by @lichuang in [#15989](https://github.com/datafuselabs/databend/pull/15989)
- 功能(查询): 添加设置sort_spilling_batch_bytes by @sundy-li in [#16019](https://github.com/datafuselabs/databend/pull/16019)
- 功能: 在HTTP处理程序结果中将nan/inf改为NaN/Infinity by @youngsofun in [#16017](https://github.com/datafuselabs/databend/pull/16017)
- 功能: 在panic时漂亮的打印回溯信息 by @andylokandy in [#16024](https://github.com/datafuselabs/databend/pull/16024)
- 功能(ast): 添加`TokenKind::{Get, Put}` by @andylokandy in [#16020](https://github.com/datafuselabs/databend/pull/16020)
- 功能(查询): 添加新设置enable_dst_hour_fix by @TCeason in [#16022](https://github.com/datafuselabs/databend/pull/16022)
- 功能: 在卸载CSV/TSV时将'inf'改为'Infinity' by @youngsofun in [#16028](https://github.com/datafuselabs/databend/pull/16028)
- 功能(查询): 实现ST_CONTAINS函数 by @kkk25641463 in [#15994](https://github.com/datafuselabs/databend/pull/15994)
- 重构: 重构聚合哈希表，用InputColumns替换&[Column] by @forsaken628 in [#16038](https://github.com/datafuselabs/databend/pull/16038)
- 功能(查询): 实现ST_SETSRID/ST_NPOINTS函数 by @kkk25641463 in [#16035](https://github.com/datafuselabs/databend/pull/16035)
- 功能: 新的表函数`set_cache_capacity` by @dantengsky in [#16016](https://github.com/datafuselabs/databend/pull/16016)
- 功能: 支持创建用户时必须更改密码选项 by @b41sh in [#16031](https://github.com/datafuselabs/databend/pull/16031)
- 功能: 多事务生成的快照具有相同的prev_snapshot_id by @SkyFan2002 in [#16044](https://github.com/datafuselabs/databend/pull/16044)
- 功能(查询): 为窗口排名函数（first_value, last_value, nth_value）添加[ IGNORE | RESPECT NULLS ]功能 by @TCeason in [#15919](https://github.com/datafuselabs/databend/pull/15919)
- 功能: 在UDF客户端头中添加函数名称 by @everpcpc in [#16053](https://github.com/datafuselabs/databend/pull/16053)
- 功能: 旧共享数据库的后向兼容性 by @lichuang in [#16056](https://github.com/datafuselabs/databend/pull/16056)
- 功能: 使用本地时间记录文件 by @everpcpc in [#16064](https://github.com/datafuselabs/databend/pull/16064)
- 功能: 添加共享集成测试 by @lichuang in [#16051](https://github.com/datafuselabs/databend/pull/16051)
- 功能(查询): 实现LocalShuffle by @Freejww in [#16055](https://github.com/datafuselabs/databend/pull/16055)
- 功能(查询): 添加设置enable_strict_datetime_parser by @TCeason in [#16067](https://github.com/datafuselabs/databend/pull/16067)
- 功能: 提高选择性准确性 by @xudong963 in [#16069](https://github.com/datafuselabs/databend/pull/16069)
- 功能: 优化败者树，禁用peek top2 by @forsaken628 in [#15979](https://github.com/datafuselabs/databend/pull/15979)
- 功能(存储): 添加表函数clustering_statistics by @zhyass in [#16081](https://github.com/datafuselabs/databend/pull/16081)
- 功能: 限制从列存储加载时的自动类型转换 by @youngsofun in [#16082](https://github.com/datafuselabs/databend/pull/16082)
- 功能(查询): PartitionsShuffleKind::ConsistentHash支持 by @forsaken628 in [#16094](https://github.com/datafuselabs/databend/pull/16094)
- 功能(HTTP): 将查询队列长度暴露给/v1/status by @flaneur2020 in [#16112](https://github.com/datafuselabs/databend/pull/16112)
- 功能(存储): 重构recluster by @zhyass in [#16070](https://github.com/datafuselabs/databend/pull/16070)
- 功能(查询): 支持可空响应的JSON NULL by @everpcpc in [#16120](https://github.com/datafuselabs/databend/pull/16120)
- 功能(查询): 窗口中的哈希分区支持 by @Freejww in [#16090](https://github.com/datafuselabs/databend/pull/16090)
- 功能: 生成准确的直方图 by @xudong963 in [#16018](https://github.com/datafuselabs/databend/pull/16018)
- 功能(查询): 添加SQL变量支持 by @sundy-li in [#16134](https://github.com/datafuselabs/databend/pull/16134)
- 功能(查询): 支持解析创建字典语句 by @Winnie-Hong0927 in [#16137](https://github.com/datafuselabs/databend/pull/16137)
- 功能(存储): 重构compact by @zhyass in [#16119](https://github.com/datafuselabs/databend/pull/16119)
- 功能: 在fuse_statistic表中添加直方图信息 by @xudong963 in [#16141](https://github.com/datafuselabs/databend/pull/16141)
- 功能(查询): 添加用户函数管理API by @zhang2014 in [#16146](https://github.com/datafuselabs/databend/pull/16146)
- 功能: 在`system.tables`中添加`is_attach`列，并禁用附加表的索引创建 by @dantengsky in [#16166](https://github.com/datafuselabs/databend/pull/16166)
- 功能(规划器): 统一DML语句（MERGE, UPDATE, DELETE）的执行 by @Dousir9 in [#16060](https://github.com/datafuselabs/databend/pull/16060)
- 功能(查询): 支持`json_array_agg`函数 by @b41sh in [#16169](https://github.com/datafuselabs/databend/pull/16169)
- 功能: 添加共享目录 by @lichuang in [#16172](https://github.com/datafuselabs/databend/pull/16172)
- 功能: 在explain analyze中输出部分信息，用于调试基数估计器 by @xudong963 in [#16185](https://github.com/datafuselabs/databend/pull/16185)
- 功能: 为meta-service添加转移领导者命令 by @drmingdrmer in [#16198](https://github.com/datafuselabs/databend/pull/16198)
- 功能: meta-service转移领导者: 添加响应和默认值 by @drmingdrmer in [#16201](https://github.com/datafuselabs/databend/pull/16

- fix(query): 列出用户阶段时未检查权限，由 @TCeason 在 [#15800](https://github.com/datafuselabs/databend/pull/15800) 修复
- fix: 修复函数调用中使用序列的问题，由 @lichuang 在 [#15814](https://github.com/datafuselabs/databend/pull/15814) 修复
- fix: 多表插入与横向展平导致 panic，由 @dantengsky 在 [#15822](https://github.com/datafuselabs/databend/pull/15822) 修复
- fix: 使用 uuid() 作为默认值导致复制错误，由 @youngsofun 在 [#15837](https://github.com/datafuselabs/databend/pull/15837) 修复
- fix: 函数 uuid() 应为非确定性，由 @youngsofun 在 [#15840](https://github.com/datafuselabs/databend/pull/15840) 修复
- fix: 源重命名后流非法，由 @zhyass 在 [#15843](https://github.com/datafuselabs/databend/pull/15843) 修复
- fix: 解析原始值中的注释，由 @andylokandy 在 [#15834](https://github.com/datafuselabs/databend/pull/15834) 修复
- fix(query): to_timestmap 在解析错误时应始终返回错误，由 @TCeason 在 [#15850](https://github.com/datafuselabs/databend/pull/15850) 修复
- fix(query): 修复 decimal 除法溢出，由 @sundy-li 在 [#15856](https://github.com/datafuselabs/databend/pull/15856) 修复
- fix(query): 修复 sum 重写器，由 @sundy-li 在 [#15870](https://github.com/datafuselabs/databend/pull/15870) 修复
- fix: 合并时未解决的冲突，由 @zhyass 在 [#15884](https://github.com/datafuselabs/databend/pull/15884) 修复
- fix(query): 窗口函数越界访问导致 panic，由 @shamb0 在 [#15860](https://github.com/datafuselabs/databend/pull/15860) 修复
- fix: 修改表后流错误，由 @zhyass 在 [#15907](https://github.com/datafuselabs/databend/pull/15907) 修复
- fix(query): 修复表达式栈溢出 [第一部分]，由 @zhang2014 在 [#15790](https://github.com/datafuselabs/databend/pull/15790) 修复
- fix(jwks): 在未找到密钥 ID 时刷新 jwks 存储，由 @flaneur2020 在 [#15921](https://github.com/datafuselabs/databend/pull/15921) 修复
- fix(query): 修复集群模式栈溢出，由 @zhang2014 在 [#15927](https://github.com/datafuselabs/databend/pull/15927) 修复
- fix: 移除 VisitorWithParent，增加更多 delete/update 子查询测试，由 @lichuang 在 [#15526](https://github.com/datafuselabs/databend/pull/15526) 修复
- fix: 非递归 CTE 引用自身，由 @xudong963 在 [#15941](https://github.com/datafuselabs/databend/pull/15941) 修复
- fix(query): 修复 CI 发布模式下的栈溢出，由 @zhang2014 在 [#15944](https://github.com/datafuselabs/databend/pull/15944) 修复
- fix(query): 窗口函数在 max_block_size 较小时 panic，由 @TCeason 在 [#15949](https://github.com/datafuselabs/databend/pull/15949) 修复
- fix: 升级快照 v002 到 v003 时，在过期索引后放置 kvs，由 @drmingdrmer 在 [#15947](https://github.com/datafuselabs/databend/pull/15947) 修复
- fix(meta): 修复保留数错误，由 @TCeason 在 [#15955](https://github.com/datafuselabs/databend/pull/15955) 修复
- fix(storage): 流显示列可能错误，由 @zhyass 在 [#15964](https://github.com/datafuselabs/databend/pull/15964) 修复
- fix: 更新 orc-rust 以修复读取 array<float> 列时的错误，由 @youngsofun 在 [#15968](https://github.com/datafuselabs/databend/pull/15968) 修复
- fix(query): 修复元组内部字段名带引号的问题，由 @b41sh 在 [#15973](https://github.com/datafuselabs/databend/pull/15973) 修复
- fix(query): UDF 函数支持 lambda 参数，由 @b41sh 在 [#15981](https://github.com/datafuselabs/databend/pull/15981) 修复
- fix: 从 parquet 读取时箭头模式错误，由 @SkyFan2002 在 [#15997](https://github.com/datafuselabs/databend/pull/15997) 修复
- fix(query): 修复删除带引号的表列，由 @b41sh 在 [#16006](https://github.com/datafuselabs/databend/pull/16006) 修复
- fix(query): 修复不正确的 fast_memcmp 函数，由 @sundy-li 在 [#16008](https://github.com/datafuselabs/databend/pull/16008) 修复
- fix(query): coalesce 在参数为 null 时继续循环，由 @TCeason 在 [#16002](https://github.com/datafuselabs/databend/pull/16002) 修复
- fix(query): 统一 UDF 允许列表验证器，由 @sundy-li 在 [#16012](https://github.com/datafuselabs/databend/pull/16012) 修复
- fix: parquet 读取器中的箭头模式，由 @SkyFan2002 在 [#16004](https://github.com/datafuselabs/databend/pull/16004) 修复
- fix(query): 修复带 null 类型的 create table as query，由 @b41sh 在 [#16041](https://github.com/datafuselabs/databend/pull/16041) 修复
- fix(query): 修复模糊时间，由 @TCeason 在 [#16046](https://github.com/datafuselabs/databend/pull/16046) 修复
- fix: 输出格式中缺少 '-Infinity' 的 '-'，由 @youngsofun 在 [#16052](https://github.com/datafuselabs/databend/pull/16052) 修复
- fix(query): 如果角色未存储所有权，跳过从角色撤销所有权，由 @TCeason 在 [#16047](https://github.com/datafuselabs/databend/pull/16047) 修复
- fix(query): 填充 information_schema.views.view_definition，由 @TCeason 在 [#16065](https://github.com/datafuselabs/databend/pull/16065) 修复
- fix: 空缓冲区的 bitmap 表示空，由 @youngsofun 在 [#16066](https://github.com/datafuselabs/databend/pull/16066) 修复
- fix(query): 如果时间戳为某些值，无需初始化解析，由 @TCeason 在 [#16078](https://github.com/datafuselabs/databend/pull/16078) 修复
- fix(query): 修复读取 decimal，由 @sundy-li 在 [#16080](https://github.com/datafuselabs/databend/pull/16080) 修复
- fix(query): 修复调用实例状态时会话管理器死锁，由 @zhang2014 在 [#16088](https://github.com/datafuselabs/databend/pull/16088) 修复
- fix: 修复原生解压二进制偏移量越界，由 @b41sh 在 [#16085](https://github.com/datafuselabs/databend/pull/16085) 修复
- fix(query): 修复窗口和限制计划的 derive_stats 不正确，由 @sundy-li 在 [#16087](https://github.com/datafuselabs/databend/pull/16087) 修复
- fix: 错误的 prev 快照 ID，由 @SkyFan2002 在 [#16092](https://github.com/datafuselabs/databend/pull/16092) 修复
- fix: 数据中的错误消息，由 @youngsofun 在 [#16089](https://github.com/datafuselabs/databend/pull/16089) 修复
- fix(storage): 重新聚类可能无限循环，由 @zhyass 在 [#16096](https://github.com/datafuselabs/databend/pull/16096) 修复
- fix(query): 修复带函数的子查询失败，由 @b41sh 在 [#16103](https://github.com/datafuselabs/databend/pull/16103) 修复
- fix(query): 将字符串转换为 decimal 时尊重 numeric_cast_option 设置，由 @sundy-li 在 [#16101](https://github.com/datafuselabs/databend/pull/16101) 修复
- fix: 租户表与流，由 @zhyass 在 [#16115](https://github.com/datafuselabs/databend/pull/16115) 修复
- fix(query): 修复 collect_statistics 中的栈溢出，由 @zhang2014 在 [#16123](https://github.com/datafuselabs/databend/pull/16123) 修复
- fix(query): 还原窗口哈希分区，由 @Freejww 在 [#16129](https://github.com/datafuselabs/databend/pull/16129) 修复
- fix(query): 修复窗口哈希分区优化，由 @Freejww 在 [#16136](https://github.com/datafuselabs/databend/pull/16136) 修复
- fix: export() 和 build_snapshot() 导致的死锁，由 @drmingdrmer 在 [#16138](https://github.com/datafuselabs/databend/pull/16138) 修复
- fix: 并行 vacuum 已删除的表，由 @dantengsky 在 [#16139](https://github.com/datafuselabs/databend/pull/16139) 修复
- fix: 删除无法再访问表数据的附加表，由 @dantengsky 在 [#16125](https://github.com/datafuselabs/databend/pull/16125) 修复
- fix(query): 还原 find_eq_and_or_filter，由 @TCeason 在 [#16148](https://github.com/datafuselabs/databend/pull/16148) 修复
- fix(query): 修复添加列的默认值为不确定表达式，由 @b41sh 在 [#16153](https://github.com/datafuselabs/databend/pull/16153) 修复
- fix(query): 修复 in 操作符转换为子查询时类型转换失败，由 @b41sh 在 [#16159](https://github.com/datafuselabs/databend/pull/16159) 修复
- fix: explain analyze 缺少统计信息，由 @dqhl76 在 [#16162](https://github.com/datafuselabs/databend/pull/16162) 修复
- fix: 元数据服务：数据不一致风险，由 @drmingdrmer 在 [#16175](https://github.com/datafuselabs/databend/pull/16175) 修复
- fix(query): 减少获取表元数据调用，由 @TCeason 在 [#16170](https://github.com/datafuselabs/databend/pull/16170) 修复
- fix: 如果字符串包含非 UTF-8 字符，则忽略来自元数据 v2 的列统计信息，由 @andylokandy 在 [#16180](https://github.com/datafuselabs/databend/pull/16180) 修复
- fix(query): 支持 system.tables 中的优化或过滤器，由 @TCeason 在 [#16165](https://github.com/datafuselabs/databend/pull/16165) 修复
- fix(query): 修复带代码的 wasm UDF 运行时创建，由 @b41sh 在 [#16191](https://github.com/datafuselabs/databend/pull/16191) 修复
- fix: 完全跳过反序列化失败的列统计信息，由 @andylokandy 在 [#16192](https://github.com/datafuselabs/databend/pull/16192) 修复
- fix(query): to_year/monday... 应尊重 DST，由 @TCeason 在 [#16195](https://github.com/datafuselabs/databend/pull/16195) 修复
- fix(query): 对 decimal 乘法结果进行四舍五入，由 @sundy-li 在 [#16196](https://github.com/datafuselabs/databend/pull/16196) 修复
- fix: 表统计信息的向后兼容性，由 @dantengsky 在 [#16200](https://github.com/datafuselabs/databend/pull/16200) 修复
- fix(query): 移除 deserialize_cluster_stats，由 @sundy-li 在 [#16204](https://github.com/datafuselabs/databend/pull/16204) 修复
- fix(query): 修复常量表达式导致的索引越界，由 @zhang2014 在 [#16206](https://github.com/datafuselabs/databend/pull/16206) 修复
- fix(query): 无法使用带视图的完全限定名称，由 @TCeason 在 [#16223](https://github.com/datafuselabs/databend/pull/16223) 修复
- fix(query): 修复意外的 panic 消息，由 @zhang2014 在 [#16221](https://github.com/datafuselabs/databend/pull/16221) 修复
- fix: block_entry.memory_size，由 @forsaken628 在 [#16230](https://github.com/datafuselabs/databend/pull/16230) 修复

### 代码重构 🎉

- 重构: 将 databend-meta 二进制文件移动到单独目录中，由 @drmingdrmer 在 [#15803](https://github.com/datafuselabs/databend/pull/15803)
- 重构: 为 `AppendEntriesRequest` 自适应条目数量，由 @drmingdrmer 在 [#15805](https://github.com/datafuselabs/databend/pull/15805)
- 重构: 添加 meta-meta 兼容性测试，由 @drmingdrmer 在 [#15823](https://github.com/datafuselabs/databend/pull/15823)
- 重构: 将目录信息迁移到表信息中，由 @Xuanwo 在 [#15857](https://github.com/datafuselabs/databend/pull/15857)
- 重构(查询): 重构合并到管道中，由 @Freejww 在 [#15891](https://github.com/datafuselabs/databend/pull/15891)
- 重构(查询): 移除查询绑定器的异步操作，由 @zhang2014 在 [#15900](https://github.com/datafuselabs/databend/pull/15900)
- 重构: 目录信息已存储在表信息中，由 @Xuanwo 在 [#15902](https://github.com/datafuselabs/databend/pull/15902)
- 重构: 使 CatalogCreator 接受 Arc&lt;CatalogInfo&gt;，由 @Xuanwo 在 [#15906](https://github.com/datafuselabs/databend/pull/15906)
- 重构: 简化向管道添加转换，由 @dantengsky 在 [#15873](https://github.com/datafuselabs/databend/pull/15873)
- 重构: 改进模数谓词选择性，由 @xudong963 在 [#15917](https://github.com/datafuselabs/databend/pull/15917)
- 重构: 优化标量类型的 gen_columns_statistics()，由 @youngsofun 在 [#15909](https://github.com/datafuselabs/databend/pull/15909)
- 重构: 优化标量类型的布隆索引构建，由 @youngsofun 在 [#15910](https://github.com/datafuselabs/databend/pull/15910)
- 重构: 默认附加表为只读，由 @dantengsky 在 [#15922](https://github.com/datafuselabs/databend/pull/15922)
- 重构(集群): 重构飞行操作并添加飞行密钥，由 @zhang2014 在 [#15930](https://github.com/datafuselabs/databend/pull/15930)
- 重构: 加速 ColumnBuilder::repeat(Scalar::Null)，由 @youngsofun 在 [#15939](https://github.com/datafuselabs/databend/pull/15939)
- 重构: 升级 arrow 到 52，由 @Xuanwo 在 [#15943](https://github.com/datafuselabs/databend/pull/15943)
- 重构: 融合统计表函数，由 @xudong963 在 [#15954](https://github.com/datafuselabs/databend/pull/15954)
- 重构: 优化 OrcChunkReader，由 @youngsofun 在 [#15967](https://github.com/datafuselabs/databend/pull/15967)
- 重构: 使用 iceberg-rust 替换 icelake，由 @Xuanwo 在 [#15951](https://github.com/datafuselabs/databend/pull/15951)
- 重构: 统一事务相关代码，由 @SkyFan2002 在 [#15966](https://github.com/datafuselabs/databend/pull/15966)
- 重构: 重命名指标并调整 system.caches 表，由 @dantengsky 在 [#15996](https://github.com/datafuselabs/databend/pull/15996)
- 重构: 升级 QuotaMgr 以使用 protobuf，由 @forsaken628 在 [#15858](https://github.com/datafuselabs/databend/pull/15858)
- 重构(查询): 在分布式合并中使用 shuffle，由 @Freejww 在 [#15946](https://github.com/datafuselabs/databend/pull/15946)
- 重构: 为 queries_profiling 表添加历史记录，由 @dqhl76 在 [#16014](https://github.com/datafuselabs/databend/pull/16014)
- 重构: 优化 take_by_slices_limit_from_blocks，由 @forsaken628 在 [#15978](https://github.com/datafuselabs/databend/pull/15978)
- 重构(查询): 为 databend-query 添加崩溃处理程序，由 @zhang2014 在 [#16054](https://github.com/datafuselabs/databend/pull/16054)
- 重构: 简化 HashMethod.build_keys_state 函数签名，用 InputColumns 替换 &[(Column, DataType)]，由 @forsaken628 在 [#16050](https://github.com/datafuselabs/databend/pull/16050)
- 重构: meta-service 最多等待 1 秒关闭，由 @drmingdrmer 在 [#16104](https://github.com/datafuselabs/databend/pull/16104)
- 重构(查询): 优化聚合函数 arg_min_max，由 @forsaken628 在 [#16109](https://github.com/datafuselabs/databend/pull/16109)
- 重构(查询): 如果指定了 table_id，直接使用它，由 @TCeason 在 [#16098](https://github.com/datafuselabs/databend/pull/16098)
- 重构: 升级到 Openraft-0.10.0-alpha.2，由 @drmingdrmer 在 [#16091](https://github.com/datafuselabs/databend/pull/16091)
- 重构: 升级 OpenDAL 到 0.48.0，由 @Xuanwo 在 [#16147](https://github.com/datafuselabs/databend/pull/16147)
- 重构: 调整 trait Table 的 `table_statistics`，由 @dantengsky 在 [#16152](https://github.com/datafuselabs/databend/pull/16152)
- 重构: 为飞行服务添加重试逻辑，由 @dqhl76 在 [#16097](https://github.com/datafuselabs/databend/pull/16097)
- 重构: 重构 ShareMeta 结构，由 @lichuang 在 [#16100](https://github.com/datafuselabs/databend/pull/16100)
- 重构(查询): 优化 udf js 运行时以避免锁阻塞，由 @b41sh 在 [#16174](https://github.com/datafuselabs/databend/pull/16174)
- 重构(查询): 如果投影未查询统计/所有者，访问 system.tables 时不会获取 table_stats/ownership，由 @TCeason 在 [#16183](https://github.com/datafuselabs/databend/pull/16183)
- 重构: 改进网络错误处理，由 @drmingdrmer 在 [#16194](https://github.com/datafuselabs/databend/pull/16194)
- 重构(查询): 移除无用的 meter，由 @zhang2014 在 [#16202](https://github.com/datafuselabs/databend/pull/16202)
- 重构(查询): 移除无用的哈希构建器，由 @zhang2014 在 [#16203](https://github.com/datafuselabs/databend/pull/16203)
- 杂项: 移除未使用的 minmax，由 @zhyass 在 [#16197](https://github.com/datafuselabs/databend/pull/16197)
- 重构: 以人类可读的 Unix 时间戳显示，由 @drmingdrmer 在 [#16212](https://github.com/datafuselabs/databend/pull/16212)
- 重构: 支持 unset session|global，由 @TCeason 在 [#16214](https://github.com/datafuselabs/databend/pull/16214)
- 重构: 使用 native-tls 作为默认，由 @Xuanwo 在 [#16199](https://github.com/datafuselabs/databend/pull/16199)
- 重构: 融合表函数，由 @dantengsky 在 [#16149](https://github.com/datafuselabs/databend/pull/16149)
- 重构(查询): 使用 bigint 处理 decimal 操作溢出的回退，由 @sundy-li 在 [#16215](https://github.com/datafuselabs/databend/pull/16215)
- 重构: CrudMgr::update 仅在值更改时返回，由 @drmingdrmer 在 [#16225](https://github.com/datafuselabs/databend/pull/16225)

### 构建/测试/CI 基础设施变更 🔌

- CI: 代码重用并移除流式加载，由 @youngsofun 在 [#15811](https://github.com/datafuselabs/databend/pull/15811)
- CI: 测试未由 Databend 加载的 Parquet 文件，由 @youngsofun 在 [#15813](https://github.com/datafuselabs/databend/pull/15813)
- CI: 延长 test_stateless_standalone 的超时时间，由 @youngsofun 在 [#15936](https://github.com/datafuselabs/databend/pull/15936)
- CI: 为 nightly-2024-07-02 构建运行器，由 @Xuanwo 在 [#16033](https://github.com/datafuselabs/databend/pull/16033)

### 其他 📒

- chore: 重新聚类最终忽略错误 by @zhyass in [#15815](https://github.com/datafuselabs/databend/pull/15815)
- chore: 减少重新聚类的深度阈值 by @zhyass in [#15819](https://github.com/datafuselabs/databend/pull/15819)
- chore(query): 移除 merge into 中的冗余代码 by @Freejww in [#15812](https://github.com/datafuselabs/databend/pull/15812)
- chore: 规范化兼容性测试脚本名称 by @drmingdrmer in [#15817](https://github.com/datafuselabs/databend/pull/15817)
- chore: 修复元数据兼容性测试中的脚本 by @drmingdrmer in [#15826](https://github.com/datafuselabs/databend/pull/15826)
- chore(ci): 为元混沌测试添加报告器 by @everpcpc in [#15829](https://github.com/datafuselabs/databend/pull/15829)
- chore: 升级 arrow-udf by @sundy-li in [#15836](https://github.com/datafuselabs/databend/pull/15836)
- chore(query): 如果源是物理表，则移除 addRowNumber by @Freejww in [#15828](https://github.com/datafuselabs/databend/pull/15828)
- chore(query): show view 仅显示视图名称 by @TCeason in [#15841](https://github.com/datafuselabs/databend/pull/15841)
- chore: 修复 arrow-udf 的构建 by @Xuanwo in [#15846](https://github.com/datafuselabs/databend/pull/15846)
- chore: 更改元混沌 io 延迟参数 by @lichuang in [#15852](https://github.com/datafuselabs/databend/pull/15852)
- chore(ci): 修复重复的失败工件名称 by @everpcpc in [#15854](https://github.com/datafuselabs/databend/pull/15854)
- chore: 为 mysql 禁用递归 cte 测试 by @xudong963 in [#15853](https://github.com/datafuselabs/databend/pull/15853)
- chore(query): 添加重试日志 by @sundy-li in [#15862](https://github.com/datafuselabs/databend/pull/15862)
- chore: 重构名称和匹配表达式 by @lichuang in [#15863](https://github.com/datafuselabs/databend/pull/15863)
- chore: 更新 logcall by @andylokandy in [#15831](https://github.com/datafuselabs/databend/pull/15831)
- chore: 为查询服务镜像安装 gdb by @everpcpc in [#15875](https://github.com/datafuselabs/databend/pull/15875)
- chore(query): string_to_date/ts 不应忽略错误 by @TCeason in [#15878](https://github.com/datafuselabs/databend/pull/15878)
- chore: 修复递归 cte 挂起问题 by @xudong963 in [#15883](https://github.com/datafuselabs/databend/pull/15883)
- chore(executor): 避免 pipeline executor 的锁中毒 by @zhang2014 in [#15887](https://github.com/datafuselabs/databend/pull/15887)
- chore: 添加日志以显示是否启用分布式优化 by @xudong963 in [#15890](https://github.com/datafuselabs/databend/pull/15890)
- chore: 打印插入查询的 select 计划 by @xudong963 in [#15892](https://github.com/datafuselabs/databend/pull/15892)
- chore(query): 改进错误消息 by @sundy-li in [#15874](https://github.com/datafuselabs/databend/pull/15874)
- chore: 使用 rspack-codespan-reporting 替换 patched codespan-reporting by @andylokandy in [#15894](https://github.com/datafuselabs/databend/pull/15894)
- chore(query): udf 允许列表仅判断主机匹配 by @sundy-li in [#15896](https://github.com/datafuselabs/databend/pull/15896)
- chore: 更改元混沌 io 延迟参数 by @lichuang in [#15897](https://github.com/datafuselabs/databend/pull/15897)
- chore: 为新的 opentelementry 支持升级 minitrace by @Xuanwo in [#15700](https://github.com/datafuselabs/databend/pull/15700)
- chore(ci): 切换 runner 到 aws by @everpcpc in [#15903](https://github.com/datafuselabs/databend/pull/15903)
- chore: 改进 spiller buffer by @xudong963 in [#15904](https://github.com/datafuselabs/databend/pull/15904)
- chore: 使用 `RemoteExpr` 复制默认值到 into by @b41sh in [#15893](https://github.com/datafuselabs/databend/pull/15893)
- chore: 更新 datasets & benchmark 的域名 by @everpcpc in [#15920](https://github.com/datafuselabs/databend/pull/15920)
- chore: 移除 open sharding 二进制文件和测试 by @lichuang in [#15923](https://github.com/datafuselabs/databend/pull/15923)
- chore: 添加 issue 15791 的测试案例 by @lichuang in [#15931](https://github.com/datafuselabs/databend/pull/15931)
- chore(storage): 重新聚类时限制 compact 数量 by @zhyass in [#15926](https://github.com/datafuselabs/databend/pull/15926)
- chore: 修复函数 process_left_or_full_join_null_block 中的参数拼写错误 by @lichuang in [#15933](https://github.com/datafuselabs/databend/pull/15933)
- chore(planner): 重构 join 等值条件 by @Dousir9 in [#15924](https://github.com/datafuselabs/databend/pull/15924)
- chore(planner): 在 merge into 中细化 join_order_changed 检查 by @Dousir9 in [#15934](https://github.com/datafuselabs/databend/pull/15934)
- chore: 移除 streaming_load api by @youngsofun in [#15935](https://github.com/datafuselabs/databend/pull/15935)
- chore(query): 重新添加一些测试 by @sundy-li in [#15940](https://github.com/datafuselabs/databend/pull/15940)
- chore: 为 pr15941 添加 issue 案例 by @xudong963 in [#15945](https://github.com/datafuselabs/databend/pull/15945)
- chore(query): 在 lazy read 中启用 none lazy pruner by @sundy-li in [#15942](https://github.com/datafuselabs/databend/pull/15942)
- chore(docs): 更新 databend.rs 的域名 by @everpcpc in [#15959](https://github.com/datafuselabs/databend/pull/15959)
- chore: 升级 hive_metastore 到 0.1.0 by @Xuanwo in [#15976](https://github.com/datafuselabs/databend/pull/15976)
- chore: 将 display_ident() 移动到 ast by @andylokandy in [#15980](https://github.com/datafuselabs/databend/pull/15980)
- chore(query): show user functions 应显示内置 udfs by @TCeason in [#15990](https://github.com/datafuselabs/databend/pull/15990)
- chore(query): 修复设置 license 时的集群 ci 失败 by @zhang2014 in [#15999](https://github.com/datafuselabs/databend/pull/15999)
- chore(ci): 为集群测试添加 license by @everpcpc in [#15995](https://github.com/datafuselabs/databend/pull/15995)
- chore: 更新 nom-rule by @andylokandy in [#16009](https://github.com/datafuselabs/databend/pull/16009)
- chore: orc 和 parquet 使用 option missing_field_as by @youngsofun in [#16007](https://github.com/datafuselabs/databend/pull/16007)
- chore: 在 databend-common-ast 库中添加 repo 链接 by @lewiszlw in [#16010](https://github.com/datafuselabs/databend/pull/16010)
- chore(query): 禁止在 insert expr 中使用 agg/window/udfcall by @sundy-li in [#16015](https://github.com/datafuselabs/databend/pull/16015)
- chore: 移除未使用的 ShareEndpointManager 和 ShareTableConfig by @lichuang in [#16013](https://github.com/datafuselabs/databend/pull/16013)
- chore: 为 `system.queries_profiling` 表添加 `errors` 列和更多测试 by @dqhl76 in [#16029](https://github.com/datafuselabs/databend/pull/16029)
- chore(query): 在错误消息中添加完整表达式 by @sundy-li in [#16032](https://github.com/datafuselabs/databend/pull/16032)
- chore: 暂时禁用一个不稳定的测试 by @dqhl76 in [#16042](https://github.com/datafuselabs/databend/pull/16042)
- chore: 为 `fuse_amend` 添加权限检查 by @dantengsky in [#16045](https://github.com/datafuselabs/databend/pull/16045)
- chore: 为表 `system.malloc_stats_totals` 添加 `node` 列 by @dantengsky in [#16043](https://github.com/datafuselabs/databend/pull/16043)
- chore(query): 默认启用分布式 merge into by @Dousir9 in [#16059](https://github.com/datafuselabs/databend/pull/16059)
- chore(ci): 使用 mask 设置 license by @everpcpc in [#16061](https://github.com/datafuselabs/databend/pull/16061)
- chore(query): information_schema.tables 支持显示视图引擎 by @TCeason in [#16058](https://github.com/datafuselabs/databend/pull/16058)
- chore: 修复共享测试集成缺少 query 二进制文件的问题 by @lichuang in [#16071](https://github.com/datafuselabs/databend/pull/16071)
- chore: 升级 jsonb 版本 0.4.1 by @b41sh in [#16073](https://github.com/datafuselabs/databend/pull/16073)
- chore(query): 在 check_function 中改进错误消息 by @sundy-li in [#16075](https://github.com/datafuselabs/databend/pull/16075)
- chore(query): 修复 merge into 虚拟计算字段 by @Dousir9 in [#16086](https://github.com/datafuselabs/databend/pull/16086)
- chore: 更新 rust toolchain 到 nightly-2024-07-02 by @andylokandy in [#16026](https://github.com/datafuselabs/databend/pull/16026)
- chore(code): 更新 Cargo.lock 中的 object_store 版本 by @Dousir9 in [#16110](https://github.com/datafuselabs/databend/pull/16110)
- chore(query): 禁用 prewhere 中的内部列 by @Dousir9 in [#16108](https://github.com/datafuselabs/databend/pull/16108)
- chore(query): 为信号处理程序添加 sigaltstack by @zhang2014 in [#16122](https://github.com/datafuselabs/databend/pull/16122)
- chore(query): 限制捕获 backtrace 的帧大小 by @zhang2014 in [#16118](https://github.com/datafuselabs/databend/pull/16118)
- chore(query): 移除无用的 box processor 实现 by @zhang2014 in [#16128](https://github.com/datafuselabs/databend/pull/16128)
- chore: 解决 lints by @andylokandy in [#16127](https://github.com/datafuselabs/databend/pull/16127)
- chore: 伪造时间测试 by @dantengsky in [#16130](https://github.com/datafuselabs/databend/pull/16130)
- chore: 解决 lints (第二部分) by @andylokandy in [#16133](https://github.com/datafuselabs/databend/pull/16133)
- chore(http): 在 /v1/status 中暴露 max_running_query_executed_time by @flaneur2020 in [#16131](https://github.com/datafuselabs/databend/pull/16131)
- chore(query): 优化 tables 查询速度 by @TCeason in [#16144](https://github.com/datafuselabs/databend/pull/16144)
- chore(ci): 添加 buildkitd 配置 & 修复拼写错误 by @everpcpc in [#16151](https://github.com/datafuselabs/databend/pull/16151)
- chore: 重置 table_lock_expire_secs 默认值 by @zhyass in [#16154](https://github.com/datafuselabs/databend/pull/16154)
- chore(query): 将 udf 管理 api 移动到管理模式 by @zhang2014 in [#16155](https://github.com/datafuselabs/databend/pull/16155)
- chore: 改进解析器 by @andylokandy in [#16156](https://github.com/datafuselabs/databend/pull/16156)
- chore: 减少锁持有期间的睡眠范围 by @zhyass in [#16158](https://github.com/datafuselabs/databend/pull/16158)
- chore(ci): 拆分内部测试 sql by @